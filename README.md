# 雀魂麻将分析助手生成比赛数据统计网页
统计雀魂比赛场（团体赛）数据：队伍总得分、队伍排名、个人总得分、个人排名、出场次数、和牌率、放铳率、立直率、副露率、自摸率、平均顺位。

本仓库中的样例数据为第一届立直麻将超级联赛（常规赛），截至2023.03.16

## 1. 环境配置

推荐环境：

- Python 3.8.8
- pandas==1.2.4

## 2. 如何使用

### 2.1 使用雀魂麻将分析助手获取对局信息

先在Chrome或Edge浏览器中[安装雀魂麻将分析助手插件](https://www.bilibili.com/read/cv17873540)（推荐使用Edge浏览器，Chrome需要安装油猴插件）

使用浏览器打开[雀魂](https://game.maj-soul.net/)，进入需要获取的对局牌谱界面运行插件，复制插件Result Output中的所有内容至./data-example.xlsx表格当中（选中A2格Ctrl+V复制）

将这个表格另存为到./data文件夹中，以“年.月.日-编号.xlsx”命名（例：2023.02.07-1.xlsx）

每一局比赛对应着一个xlsx文件

- TODO：尝试使用[mahjong_soul_api](https://github.com/MahjongRepository/mahjong_soul_api)自动获取对局

### 2.2 添加比赛信息

#### 2.2.1 队伍人员信息

打开./player.xlsx，按编号顺序从0开始填写“id、name、team_id、team_name”四列内容（注意在最后一行必须添加AI，用于处理挂模切电脑的对局数据）

#### 2.2.2 比赛规则信息

使用记事本打开./config.py，在其中修改赛事名称、顺位马点、同分是否平分顺位马点、精算原点、队伍初始分数、队伍名称、参赛人员数量等信息（注意：此处的修改必须与./player.xlsx中的信息保持一致）

使用记事本打开./game_rule.txt，在其中编辑文字版的比赛章程（注意文件保存时必须保存成utf-8格式）

### 2.3 运行python程序

在本文件夹下开启命令行窗口，运行命令

```
python ./cal.py
```

### 2.4 运行输出

- 表格输出：./output.xlsx
- 网页输出：./index.html

